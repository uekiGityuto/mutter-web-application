# mutter-web-application
誰でも自由につぶやけるWEBアプリケーション
## 機能
* フォーム認証
* ユーザ登録(パスワードはbcryptアルゴリズムでハッシュ化して保存)
* 退会
* つぶやき
* つぶやきの閲覧
* 管理者機能（一般ユーザの無効化、有効化、削除）

## 環境
* Java 8
* Spring Boot 2.3.0
* JPA
* H2 Database
* Thymeleaf
* BootStrap 4.5.0

## セキュリティ対策
参考：[ipaの「安全なウェブサイトの作り方」](https://www.ipa.go.jp/files/000017316.pdf)

0. SQLインジェクション
    * JPAを利用してプログラム内で極力SQLやJPQLを使用しない
    * 使用する場合はプレースホルダーを利用する
    * DBのエラーメッセージを直接ブラウザに表示しない

0. OSコマンドインジェクション
    * シェルを起動できる言語機能を利用しない

0. ディレクトリ・トラバーサル/パス・トラバーサル
    * 外部からのパラメータでウェブサーバ内のファイル名を直接指定しない

0. セッション・ハイジャック
    * 推測困難なセッションIDを生成する(Apache Tomcatのデフォルト設定)
    * HTTPSを使って通信を暗号化する(Pivotal Web Servicesのデフォルト設定)
    * セッションIDはCookieを使って連携する(Spring Securityのデフォルト設定)
    * CookieのHttpOnly属性を指定する(HTTPテキスト内のスクリプトからCookieにアクセスできなくする)
    * CookieにSecure属性を指定する(HTTPS通信の時だけCookieをサーバーに送信する)
    * ログアウト処理が実行されたタイミングでセッションを破棄する(Spring Securityのデフォルト設定)
    * ログアウトせずにブラウザを閉じた場合でも、15分でセッションタイムアウトにする
    * 二重ログインを禁止する(後からログインしたほうを優先)

0. セッションIDの固定化
    * ログイン成功時にセッションIDを変更する(Spring Securityのデフォルト設定)
    * セッションIDはCookieを使って連携する(Spring Securityのデフォルト設定)
    * ログアウト処理が実行されたタイミングでセッションを破棄する(Spring Securityのデフォルト設定)
    * ログアウトせずにブラウザを閉じた場合でも、15分でセッションタイムアウトにする
    * 二重ログインを禁止する(後からログインしたほうを優先)

0. クロスサイト・スクリプティング
    * HTMLタグをサニタイズする(Thymeleafはデフォルトでth:textでサニタイズする)
    * HTTP レスポンスヘッダの Content-Type フィールドに文字コード(charset)を指定する
    * CookieのHttpOnly属性を指定する(HTTPテキスト内のスクリプトからCookieにアクセスできなくする)

0. CSRF(クロスサイト・リクエスト・フォージェリ)
    * POSTメソッドを使用したリクエストに対して、CSRFトークンチェックを行う(Spring Securityのデフォルト設定)

0. HTTPヘッダ・インジェクション
    * HTTPレスポンスヘッダのフィールド値は外部から渡されるパラメータの値等を利用しない

0. メールヘッダ・インジェクション
    * メール機能をもたない(メール機能を追加する場合はメールヘッダを固定値にする)

0. クリックジャギング
    * HTTPレスポンスヘッダに、X-Frame-Options=DENYをセットし、
    外部サイトからのframe要素やiframe要素による読み込みを禁止する(Spring Securityのデフォルト設定)　

0. バッファオーバーフロー
    * 直接メモリにアクセスできない言語(Java)で記述する

0. アクセス制御の欠落
    * ログインにはユーザ名とパスワードを必要とする
    * 管理者権限とユーザ権限を分ける

0. 認可制御の欠落
    * ユーザ権限でアクセス出来るページでは、リクエストパラメータにユーザ名等のユーザを一意に識別するキーを埋め込まず、
    セッションIDからユーザ名を取得する
    * ユーザ管理機能は管理者者のみ認可する
